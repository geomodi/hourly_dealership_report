
    <!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/css/bootstrap.min.css" rel="stylesheet">
        <style>
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                margin: 0;
                padding: 0;
                background-color: #f4f4f4;
            }
            .header {
                background-color: #007bff;
                color: #fff;
                padding: 10px 0;
                text-align: center;
                font-size: 24px;
            }
            .container {
                width: 100%;
                margin: 10px auto;
            }
            .search-box {
                width: 100%;
                padding: 8px;
                margin-top: 10px;
                margin-bottom: 10px;
                border: 1px solid #ddd;
                border-radius: 4px;
            }
            .button, .btn-sm {
                padding: 10px;
                margin: 5px 0;
                cursor: pointer;
            }
            .table {
                border-collapse: collapse;
                font-size: 13px;            
                width: 100%;
                margin-bottom: 10px;
            }
            .table th, .table td {
                text-align: left;
                padding: 8px;
                border: 1px solid #ddd;
            }
            .table th {
                background-color: #17a2b8;
                color: white;
            }
            .table tr:nth-child(even) {
                background-color: #f2f2f2;
            }
            .table tr:hover {
                background-color: #ddd;
            }
        </style>
    </head>
    <body>
        <div class="header">Dealership Data Report</div>
        <div class="container">
            <input type="text" id="searchBox" class="form-control search-box" placeholder="Type to search..." onkeyup="searchTable()">
            <button onclick="filterByDealership('Betten Baker Buick GMC')" class="btn btn-info btn-sm m-1">Betten Baker Buick GMC</button>
<button onclick="filterByDealership('Betten Baker Buick GMC Midland')" class="btn btn-info btn-sm m-1">Betten Baker Buick GMC Midland</button>
<button onclick="filterByDealership('Cronic CDJR')" class="btn btn-info btn-sm m-1">Cronic CDJR</button>
<button onclick="filterByDealership('Cronic Nissan')" class="btn btn-info btn-sm m-1">Cronic Nissan</button>
<button onclick="filterByDealership('Keffer CDJR')" class="btn btn-info btn-sm m-1">Keffer CDJR</button>
<button onclick="filterByDealership('Keffer Mazda')" class="btn btn-info btn-sm m-1">Keffer Mazda</button>
<button onclick="filterByDealership('Keffer Volkswagen')" class="btn btn-info btn-sm m-1">Keffer Volkswagen</button>
<button onclick="filterByDealership('Mike Reichenbach Ford')" class="btn btn-info btn-sm m-1">Mike Reichenbach Ford</button>
<button onclick="filterByDealership('Mike Reichenbach Volkswagen')" class="btn btn-info btn-sm m-1">Mike Reichenbach Volkswagen</button>
<button onclick="filterByDealership('Nissan of Hendersonville')" class="btn btn-info btn-sm m-1">Nissan of Hendersonville</button>
<button onclick="filterByDealership('Nissan of Newnan')" class="btn btn-info btn-sm m-1">Nissan of Newnan</button>
<button onclick="filterByDealership('Nissan of Orangeburg')" class="btn btn-info btn-sm m-1">Nissan of Orangeburg</button>
<button onclick="filterByDealership('Nissan of Richmond')" class="btn btn-info btn-sm m-1">Nissan of Richmond</button>
<button onclick="filterByDealership('Nissan of South Morrow')" class="btn btn-info btn-sm m-1">Nissan of South Morrow</button>
<button onclick="filterByDealership('Nissan of Union City')" class="btn btn-info btn-sm m-1">Nissan of Union City</button>
<button onclick="filterByDealership('Santee CDJR')" class="btn btn-info btn-sm m-1">Santee CDJR</button>
<button onclick="filterByDealership('Santee Ford')" class="btn btn-info btn-sm m-1">Santee Ford</button>
<button onclick="filterByDealership('Southtowne Hyundai of Newnan')" class="btn btn-info btn-sm m-1">Southtowne Hyundai of Newnan</button>
<button onclick="filterByDealership('Southtowne Hyundai of Riverdale')" class="btn btn-info btn-sm m-1">Southtowne Hyundai of Riverdale</button>
<button onclick="filterByDealership('Summerville Ford')" class="btn btn-info btn-sm m-1">Summerville Ford</button>
<button onclick="filterByDealership('Sumter CDJR')" class="btn btn-info btn-sm m-1">Sumter CDJR</button>
<button onclick="filterByDealership('Tenneson Nissan')" class="btn btn-info btn-sm m-1">Tenneson Nissan</button>
<button onclick="filterByDealership('Union City CDJR')" class="btn btn-info btn-sm m-1">Union City CDJR</button>
<button onclick="filterByDealership('Volkswagen of New Port Richey')" class="btn btn-info btn-sm m-1">Volkswagen of New Port Richey</button>
            <button onclick="showLatestHourData()" class="btn btn-primary btn-sm m-1">Latest Hour Data</button>
            <button onclick="resetFilters()" class="btn btn-secondary btn-sm m-1">Reset Filters</button>
            <div class="table-responsive">
                <table border="1" class="dataframe table" id="data_table">
  <thead>
    <tr style="text-align: right;">
      <th>Dealership Name</th>
      <th>Total Appointments</th>
      <th>Confirmed</th>
      <th>Shown</th>
      <th>No Show</th>
      <th>Overdue</th>
      <th>Sold</th>
      <th>Appointments For Tomorrow</th>
      <th>Timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Betten Baker Buick GMC</td>
      <td>8</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>11/22/2023, 09:29:41 AM</td>
    </tr>
    <tr>
      <td>Betten Baker Buick GMC</td>
      <td>8</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>11/22/2023, 10:01:10 AM</td>
    </tr>
    <tr>
      <td>Betten Baker Buick GMC Midland</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>None</td>
      <td>11/22/2023, 12:59:32 AM</td>
    </tr>
    <tr>
      <td>Betten Baker Buick GMC Midland</td>
      <td>5</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>11/22/2023, 09:29:05 AM</td>
    </tr>
    <tr>
      <td>Betten Baker Buick GMC Midland</td>
      <td>5</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>11/22/2023, 10:01:09 AM</td>
    </tr>
    <tr>
      <td>Cronic CDJR</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>None</td>
      <td>11/22/2023, 12:59:33 AM</td>
    </tr>
    <tr>
      <td>Cronic CDJR</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>11/22/2023, 09:27:51 AM</td>
    </tr>
    <tr>
      <td>Cronic CDJR</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>11/22/2023, 10:01:12 AM</td>
    </tr>
    <tr>
      <td>Cronic Nissan</td>
      <td>8</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>None</td>
      <td>11/22/2023, 12:59:36 AM</td>
    </tr>
    <tr>
      <td>Cronic Nissan</td>
      <td>8</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>8</td>
      <td>11/22/2023, 09:40:30 AM</td>
    </tr>
    <tr>
      <td>Cronic Nissan</td>
      <td>8</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>11/22/2023, 10:00:36 AM</td>
    </tr>
    <tr>
      <td>Keffer CDJR</td>
      <td>26</td>
      <td>10</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>11/22/2023, 09:36:02 AM</td>
    </tr>
    <tr>
      <td>Keffer CDJR</td>
      <td>26</td>
      <td>10</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>11/22/2023, 10:01:12 AM</td>
    </tr>
    <tr>
      <td>Keffer Mazda</td>
      <td>12</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>11/22/2023, 09:37:31 AM</td>
    </tr>
    <tr>
      <td>Keffer Mazda</td>
      <td>12</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>11/22/2023, 10:01:12 AM</td>
    </tr>
    <tr>
      <td>Keffer Volkswagen</td>
      <td>13</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>11/22/2023, 09:38:19 AM</td>
    </tr>
    <tr>
      <td>Keffer Volkswagen</td>
      <td>13</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>11/22/2023, 10:01:07 AM</td>
    </tr>
    <tr>
      <td>Mike Reichenbach Ford</td>
      <td>8</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>11/22/2023, 09:31:05 AM</td>
    </tr>
    <tr>
      <td>Mike Reichenbach Ford</td>
      <td>8</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>11/22/2023, 10:01:12 AM</td>
    </tr>
    <tr>
      <td>Mike Reichenbach Volkswagen</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>11/22/2023, 09:32:08 AM</td>
    </tr>
    <tr>
      <td>Mike Reichenbach Volkswagen</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>11/22/2023, 10:01:12 AM</td>
    </tr>
    <tr>
      <td>Nissan of Hendersonville</td>
      <td>10</td>
      <td>6</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>11/22/2023, 09:42:37 AM</td>
    </tr>
    <tr>
      <td>Nissan of Hendersonville</td>
      <td>10</td>
      <td>6</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>11/22/2023, 10:01:11 AM</td>
    </tr>
    <tr>
      <td>Nissan of Newnan</td>
      <td>10</td>
      <td>6</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>11/22/2023, 09:43:10 AM</td>
    </tr>
    <tr>
      <td>Nissan of Newnan</td>
      <td>10</td>
      <td>6</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>11/22/2023, 10:01:12 AM</td>
    </tr>
    <tr>
      <td>Nissan of Orangeburg</td>
      <td>10</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>11/22/2023, 09:43:42 AM</td>
    </tr>
    <tr>
      <td>Nissan of Orangeburg</td>
      <td>10</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>11/22/2023, 10:01:12 AM</td>
    </tr>
    <tr>
      <td>Nissan of Richmond</td>
      <td>17</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>11/22/2023, 09:41:34 AM</td>
    </tr>
    <tr>
      <td>Nissan of Richmond</td>
      <td>17</td>
      <td>3</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>11/22/2023, 10:01:10 AM</td>
    </tr>
    <tr>
      <td>Nissan of South Morrow</td>
      <td>30</td>
      <td>17</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>30</td>
      <td>11/22/2023, 09:44:26 AM</td>
    </tr>
    <tr>
      <td>Nissan of South Morrow</td>
      <td>32</td>
      <td>18</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>11/22/2023, 10:01:12 AM</td>
    </tr>
    <tr>
      <td>Nissan of Union City</td>
      <td>30</td>
      <td>8</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>11/22/2023, 09:44:59 AM</td>
    </tr>
    <tr>
      <td>Nissan of Union City</td>
      <td>31</td>
      <td>8</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>1</td>
      <td>11/22/2023, 10:01:08 AM</td>
    </tr>
    <tr>
      <td>Santee CDJR</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>11/22/2023, 09:24:38 AM</td>
    </tr>
    <tr>
      <td>Santee CDJR</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>11/22/2023, 10:01:09 AM</td>
    </tr>
    <tr>
      <td>Santee Ford</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>11/22/2023, 09:23:41 AM</td>
    </tr>
    <tr>
      <td>Santee Ford</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>11/22/2023, 10:01:07 AM</td>
    </tr>
    <tr>
      <td>Southtowne Hyundai of Newnan</td>
      <td>25</td>
      <td>6</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>11/22/2023, 09:39:19 AM</td>
    </tr>
    <tr>
      <td>Southtowne Hyundai of Newnan</td>
      <td>26</td>
      <td>6</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>11/22/2023, 10:01:12 AM</td>
    </tr>
    <tr>
      <td>Southtowne Hyundai of Riverdale</td>
      <td>25</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>25</td>
      <td>11/22/2023, 09:39:59 AM</td>
    </tr>
    <tr>
      <td>Southtowne Hyundai of Riverdale</td>
      <td>25</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>11/22/2023, 10:01:12 AM</td>
    </tr>
    <tr>
      <td>Summerville Ford</td>
      <td>8</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>11/22/2023, 09:34:44 AM</td>
    </tr>
    <tr>
      <td>Summerville Ford</td>
      <td>8</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>11/22/2023, 10:01:07 AM</td>
    </tr>
    <tr>
      <td>Sumter CDJR</td>
      <td>8</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>11/22/2023, 09:33:36 AM</td>
    </tr>
    <tr>
      <td>Sumter CDJR</td>
      <td>8</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>11/22/2023, 10:01:09 AM</td>
    </tr>
    <tr>
      <td>Tenneson Nissan</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>None</td>
      <td>11/22/2023, 12:59:36 AM</td>
    </tr>
    <tr>
      <td>Tenneson Nissan</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>11/22/2023, 09:35:29 AM</td>
    </tr>
    <tr>
      <td>Tenneson Nissan</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>11/22/2023, 10:01:07 AM</td>
    </tr>
    <tr>
      <td>Union City CDJR</td>
      <td>10</td>
      <td>8</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>11/22/2023, 09:26:27 AM</td>
    </tr>
    <tr>
      <td>Union City CDJR</td>
      <td>10</td>
      <td>8</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>11/22/2023, 10:01:12 AM</td>
    </tr>
    <tr>
      <td>Volkswagen of New Port Richey</td>
      <td>8</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>11/22/2023, 09:25:47 AM</td>
    </tr>
    <tr>
      <td>Volkswagen of New Port Richey</td>
      <td>8</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>11/22/2023, 10:01:12 AM</td>
    </tr>
  </tbody>
</table>
            </div>
        </div>
        <script>
            function searchTable() {
                var input, filter, table, tr, td, i;
                input = document.getElementById("searchBox");
                filter = input.value.toUpperCase();
                table = document.getElementById("data_table");
                tr = table.getElementsByTagName("tr");
                
                for (i = 1; i < tr.length; i++) {
                    td = tr[i].getElementsByTagName("td")[0]; // Assuming the dealership name is in the first column
                    if (td) {
                        if (td.textContent.toUpperCase().indexOf(filter) > -1) {
                            tr[i].style.display = "";
                        } else {
                            tr[i].style.display = "none";
                        }
                    }       
                }
            }
            
            function filterByDealership(dealership) {
                var table, tr, td, i, cellValue;
                table = document.getElementById("data_table");
                tr = table.getElementsByTagName("tr");
                
                for (i = 1; i < tr.length; i++) {
                    td = tr[i].getElementsByTagName("td")[0]; // Assuming the dealership name is in the first column
                    cellValue = td.textContent || td.innerText;
                    
                    if (cellValue === dealership) {
                        tr[i].style.display = "";
                    } else {
                        tr[i].style.display = "none";
                    }
                }
            }
            
            function showLatestHourData() {
                var table, tr, td, i, maxDate, currentDate, currentDateTime;
                table = document.getElementById("data_table");
                tr = table.getElementsByTagName("tr");
                maxDate = new Date(0); // Initialize to earliest date
                
                // Find the max date (latest hour data)
                for (i = 1; i < tr.length; i++) {
                    td = tr[i].getElementsByTagName("td");
                    currentDate = new Date(td[td.length - 1].textContent || td[td.length - 1].innerText); // Assuming date is in the last column
                    
                    if (currentDate > maxDate) {
                        maxDate = currentDate;
                    }
                }
                
                // Convert maxDate to start of hour
                maxDate.setMinutes(0);
                maxDate.setSeconds(0);
                maxDate.setMilliseconds(0);
                
                currentDateTime = maxDate.getTime();
                
                // Show only rows with the latest hour data
                for (i = 1; i < tr.length; i++) {
                    td = tr[i].getElementsByTagName("td");
                    currentDate = new Date(td[td.length - 1].textContent || td[td.length - 1].innerText); // Assuming date is in the last column
                    currentDate.setMinutes(0);
                    currentDate.setSeconds(0);
                    currentDate.setMilliseconds(0);
                    
                    if (currentDate.getTime() === currentDateTime) {
                        tr[i].style.display = "";
                    } else {
                        tr[i].style.display = "none";
                    }
                }
            }
            
            function resetFilters() {
                var table, tr, i;
                table = document.getElementById("data_table");
                tr = table.getElementsByTagName("tr");
                
                for (i = 1; i < tr.length; i++) {
                    tr[i].style.display = "";
                }
                
                // Clear the search box
                document.getElementById("searchBox").value = "";
            }
            
            // Call showLatestHourData() initially to display only the latest hour data
            showLatestHourData();
        </script>
    </body>
    </html>
    